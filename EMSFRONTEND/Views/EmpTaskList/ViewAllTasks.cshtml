@model IEnumerable<EMSFRONTEND.Models.TaskWithFullNameDto>

<h2>View All Assigned Tasks to the Employees</h2>

<table class="table table-striped table-bordered table-hover">
    <thead class="thead-light">
        <tr>

            <th>UserName</th>
            <th>TaskName</th>
            <th>AssignedDate</th>
            <th>DeadlineDate</th>
            <th>Description</th>
            <th>TaskStatus</th>
            <th>Resources</th>
            <th>Action</th> <!-- New Action Column -->
        </tr>
    </thead>
    <tbody>
        @foreach (var upload in Model)
        {
                <tr>

                    <td>@upload.FullName</td>
                    <td>@upload.Title</td>
                    <td>@upload.AssignedDate.ToString("MMMM dd, yyyy")</td>
                    <td>@upload.DeadlineDate.ToString("MMMM dd, yyyy")</td>
                    <td>@upload.Description</td>
                    <td>
                    @{
                        string statusColor = upload.TaskStatus switch
                        {
                            "Pending" => "text-primary bg-light", // Blue for Pending with light background
                            "Submitted" => "text-success bg-light", // Green for Submitted with light background
                            "Overdue" => "text-danger bg-light", // Red for Overdue with light background
                            _ => ""
                        };
                    }
                        <span class="@statusColor"
                              style="border-radius: 10px; padding: 5px 10px; font-weight: bold;">@upload.TaskStatus</span>
                    </td>

                    <td>
                    @{
                        var resourcePath = upload.Resources;
                        // Ensure the link starts with http:// or https://
                        if (!resourcePath.StartsWith("http://") && !resourcePath.StartsWith("https://"))
                        {
                            resourcePath = "https://" + resourcePath; // Prepend https:// to ensure proper linking
                        }
                    }
                        <a href="@resourcePath" target="_blank" class="text-primary">View Resource</a>
                    </td>

                    <td>
                    @if (upload.TaskStatus != "Overdue" && upload.TaskStatus != "Submitted")
                    {
                                <form asp-action="DeleteTask" method="post" onsubmit="return confirm('Are you sure you want to delete this task?');" style="display:inline;">
                                    <input type="hidden" name="taskId" value="@upload.TaskId" />
                                    <button type="submit" class="btn btn-link text-danger" title="Delete Task">
                                        <!-- Inline SVG for the delete icon -->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                            <path d="M2.5 1a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5V2H2v-.5zM3 2h10v1H3V2zM1 2a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1h-1.1l-.4 8a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1l-.4-8H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h1V2zm1 1h9l.4 8H4.6L5 3z" />
                                        </svg>
                                    </button>
                                </form>
                    }
                    else
                    {
                                <span>N/A</span> <!-- Optional: Display N/A or nothing -->
                    }
                    </td>


                </tr>
        }
    </tbody>
</table>


<div class="mt-4">
    <button onclick="window.history.back();" class="btn btn-secondary">Back</button>
</div>

<!-- Optional: Add some custom CSS for further styling -->
<style>
    table {
        width: 100%; 
        border-collapse: collapse; 
        margin-top: 20px; 
    }

    th, td {
        padding: 15px; 
        text-align: left; 
    }

    th {
        background-color: #f8f9fa; 
        color: #333; 
    }

    tbody tr:hover {
        background-color: #f1f1f1; 
    }

    tbody tr:nth-child(even) {
        background-color: #f9f9f9; 
    }


    /* Style for the back button */
    .btn {
        padding: 10px 20px; 
        font-size: 16px; 
        border-radius: 5px; 
        cursor: pointer; 
    }

    .btn-secondary {
        background-color: #6c757d; 
        color: white; 
        border: none; 
    }

        .btn-secondary:hover {
            background-color: #5a6268; /* Darker shade on hover */
        }
</style>